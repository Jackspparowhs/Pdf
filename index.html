<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>World Time — PirateRuler</title>
<meta name="description" content="World Time converter — client-side, no API. Live clocks for 400+ zones, search, and conversions." />
<meta name="theme-color" content="#f7fbff" />
<link rel="icon" href='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64"><rect rx="14" width="64" height="64" fill="%236b7dff"/><text x="50%" y="50%" font-family="Inter,Arial,sans-serif" font-weight="800" font-size="26" text-anchor="middle" alignment-baseline="central" fill="white">PR</text></svg>'>
<style>
  :root{
    --bg:#f3f7fb; --card:#ffffff; --muted:#6b7480; --text:#0b2130;
    --accent-start:#6b7dff; --accent-end:#0bb3ff;
    --glass: rgba(11,17,28,0.04);
    --radius:14px; --shadow-lg: 0 18px 50px rgba(3,12,30,0.18);
    --shadow-sm: 0 8px 24px rgba(3,12,30,0.08);
    --card-contrast: rgba(11,17,28,0.03);
  }
  /* gentler dark theme */
  html.dark{
    --bg:#071827;
    --card:#0b2130;
    --muted:#98a7bf;
    --text:#e7f6ff;
    --accent-start:#5ab3ff;
    --accent-end:#6b7dff;
    --glass: rgba(255,255,255,0.02);
    --card-contrast: rgba(255,255,255,0.02);
  }
  html.ocean { --bg:#e8f7fb; --card:#ffffff; --muted:#4f6b75; --text:#063242; --accent-start:#00c2d1; --accent-end:#2b9fff; }
  html.sunset { --bg:#fff6f8; --card:#fff; --muted:#7a6b77; --text:#2a1020; --accent-start:#ff7aa2; --accent-end:#ffb86b; }

  *{box-sizing:border-box}
  body{background:linear-gradient(180deg,var(--bg), #e9f6ff); font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial; color:var(--text); margin:0; -webkit-font-smoothing:antialiased;}
  a{color:inherit;text-decoration:none}
  .container{max-width:1100px;margin:14px auto;padding:14px}

  header.header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px;border-radius:12px;background:linear-gradient(90deg, rgba(107,125,255,0.06), rgba(11,179,255,0.02));box-shadow:var(--shadow-sm)}
  .brand{display:flex;gap:12px;align-items:center;min-width:0}
  .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent-start),var(--accent-end));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:900}
  .title-strong{font-size:18px;font-weight:900;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .by{font-size:12px;color:var(--muted);margin-top:2px}
  .header-actions{display:flex;align-items:center;gap:8px}
  .btn{padding:8px 10px;border-radius:10px;border:none;cursor:pointer;font-weight:800;background:transparent}
  .btn.ghost{background:transparent;border:1px solid rgba(0,0,0,0.06)}
  .btn.theme{background:linear-gradient(90deg,var(--accent-start),var(--accent-end));color:#fff;border-radius:999px;padding:8px 12px}
  .hamb{width:46px;height:46px;border-radius:10px;background:var(--glass);display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid rgba(0,0,0,0.04)}

  .hero{margin-top:16px;padding:18px;border-radius:14px;background:var(--card);box-shadow:var(--shadow-lg);border:1px solid var(--card-contrast)}
  .hero .title{font-size:22px;font-weight:900;margin:0}
  .hero .hint{color:var(--muted);margin-top:6px}
  .controls{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap;align-items:center}
  .input{flex:1;min-width:180px}
  input[type="text"], input[type="number"], select { width:100%;padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);font-size:16px;background:var(--card);color:var(--text) }
  .primary{background:linear-gradient(90deg,var(--accent-start),var(--accent-end));color:white;padding:10px 16px;border-radius:10px;border:none;font-weight:800;cursor:pointer}
  .small-actions{display:flex;gap:8px;align-items:center;margin-left:8px}

  .grid{display:grid;grid-template-columns:1fr;gap:18px;margin-top:12px}
  .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:var(--shadow-sm);border:1px solid var(--card-contrast)}
  .card h2{margin:0 0 8px 0;font-size:18px}
  .hint{color:var(--muted);font-size:13px}

  .list{margin-top:12px;display:grid;gap:10px}
  .zone-row{display:flex;flex-direction:column;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.6), transparent);border:1px solid rgba(0,0,0,0.04)}
  html.dark .zone-row{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent)}
  .zone-top{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .zone-name{font-weight:900;color:var(--accent-start)}
  .zone-meta{color:var(--muted);font-size:13px;margin-top:6px}
  .tiny{font-size:13px;color:var(--muted)}

  .footer{margin-top:18px;padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.92), rgba(255,255,255,0.96));text-align:center;box-shadow:var(--shadow-lg)}
  .visit{padding:10px 18px;border-radius:999px;background:linear-gradient(90deg,#ff7aa2 0%, #6b7dff 100%);color:#fff;font-weight:800;text-decoration:none;display:inline-block}
  .muted{color:var(--muted)}

  .sidebar{position:fixed;right:0;top:0;height:100vh;width:360px;background:var(--card);box-shadow:-40px 0 80px rgba(2,8,20,0.25);padding:18px;transform:translateX(110%);transition:transform .28s cubic-bezier(.2,.9,.3,1);border-left:1px solid var(--card-contrast);z-index:999}
  .sidebar.open{transform:translateX(0)}
  .sidebar h3{margin:0 0 8px 0}
  .sidebar a{display:block;padding:8px;border-radius:8px;color:var(--text);text-decoration:none}
  .sidebar .muted{color:var(--muted);font-size:13px}

  @media(min-width:900px){
    .grid{grid-template-columns: 1fr 420px}
  }

  .controls-actions{display:flex;gap:8px;align-items:center}
  .show-all{background:transparent;border:none;color:var(--accent-start);font-weight:800;cursor:pointer}
</style>
</head>
<body>
<div class="container">

  <header class="header" role="banner">
    <div class="brand">
      <div class="logo" aria-hidden="true">PR</div>
      <div>
        <div class="title-strong">World Time</div>
        <div class="by">by PirateRuler.com</div>
      </div>
    </div>

    <div class="header-actions" role="navigation">
      <div class="theme-select" id="themeSelectWrap" style="position:relative">
        <button id="themeBtn" class="btn theme" title="Theme">Ocean ▾</button>
        <div id="themeList" style="display:none;position:absolute;right:0;top:48px;background:var(--card);border-radius:10px;padding:8px;box-shadow:var(--shadow-sm);z-index:1000;">
          <div class="theme-item" data-theme="light" style="padding:8px;cursor:pointer">Light</div>
          <div class="theme-item" data-theme="dark" style="padding:8px;cursor:pointer">Dark</div>
          <div class="theme-item" data-theme="ocean" style="padding:8px;cursor:pointer">Ocean</div>
          <div class="theme-item" data-theme="sunset" style="padding:8px;cursor:pointer">Sunset</div>
        </div>
      </div>
      <div id="hambBtn" class="hamb" title="Open menu" aria-controls="sidebar">☰</div>
    </div>
  </header>

  <section class="hero card" aria-labelledby="heroTitle">
    <h1 id="heroTitle" class="title">World Time Converter</h1>
    <div class="hint">Live clocks for every timezone (browser IANA list when available). Client-side — no API.</div>

    <div class="controls" style="margin-top:14px">
      <div class="input">
        <input id="searchInput" type="text" placeholder="Search timezones or city e.g. 'London', 'America/New_York'">
      </div>
      <div style="width:110px">
        <select id="presetSelect">
          <option value="famous">Famous (default)</option>
          <option value="all">All zones</option>
        </select>
      </div>
      <div class="controls-actions">
        <button id="refreshBtn" class="primary">Refresh</button>
        <button id="showAllBtn" class="show-all" title="Show all zones">Show all zones</button>
      </div>
    </div>

    <div style="margin-top:12px" class="tiny">UTC now: <span id="utcNow"></span></div>
  </section>

  <main class="grid" role="main">
    <div>
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div><strong id="countLabel">0</strong> zones</div>
          <div class="tiny" id="liveHint">Live clocks — updates every second</div>
        </div>

        <div id="zonesList" class="list" aria-live="polite" style="margin-top:12px"></div>
      </div>
    </div>

    <aside class="card feature-panel" role="complementary">
      <div style="display:flex;justify-content:flex-end"><button id="closeSidebar" class="btn ghost">Close</button></div>
      <h3>About</h3>
      <p class="muted">This tool uses the browser's timezone database (Intl) to list supported IANA time zones. Works fully offline and auto-updates for DST using built-in Intl rules.</p>

      <div style="margin-top:10px">
        <a href="https://pirateruler.com/post/about.html" target="_blank" rel="noopener noreferrer">About — PirateRuler</a><br/>
        <a href="https://pirateruler.com/post/privacy.html" target="_blank" rel="noopener noreferrer">Privacy Policy</a><br/>
        <a href="https://pirateruler.com/post/contact.html" target="_blank" rel="noopener noreferrer">Contact</a><br/>
        <a href="https://pirateruler.com/post/terms.html" target="_blank" rel="noopener noreferrer">Terms & Service</a>
      </div>

      <div style="margin-top:14px">
        <div style="font-weight:800">Quick actions</div>
        <div style="margin-top:8px">
          <button id="jumpLocal" class="primary" style="width:100%;margin-bottom:8px">Jump to local time</button>
          <button id="showUTC" class="ghost" style="width:100%;margin-bottom:8px">Show UTC</button>
          <button id="copyZones" class="ghost" style="width:100%">Copy zone list</button>
        </div>
      </div>
    </aside>
  </main>

  <footer class="footer">
    <a class="visit" href="https://pirateruler.com" target="_blank" rel="noopener noreferrer">Visit PirateRuler.com</a>
    <div style="height:8px"></div>
    <small class="muted">© <span id="year"></span> PirateRuler — World Time. Client-side — no API.</small>
  </footer>
</div>

<!-- Sidebar (hidden duplicate for small screens) -->
<aside id="sidebar" class="sidebar" aria-hidden="true">
  <div style="display:flex;justify-content:flex-end"><button id="closeSidebar2" class="btn ghost">Close</button></div>
  <h3>PirateRuler Links</h3>
  <nav style="display:flex;flex-direction:column;gap:8px;margin-top:10px">
    <a href="https://pirateruler.com/post/about.html" target="_blank" rel="noopener noreferrer">About — PirateRuler</a>
    <a href="https://pirateruler.com/post/privacy.html" target="_blank" rel="noopener noreferrer">Privacy Policy</a>
    <a href="https://pirateruler.com/post/contact.html" target="_blank" rel="noopener noreferrer">Contact</a>
    <a href="https://pirateruler.com/post/terms.html" target="_blank" rel="noopener noreferrer">Terms & Service</a>
  </nav>
  <div style="margin-top:18px;color:var(--muted);font-size:13px">Backup & resources: <a href="https://pirateruler.com" target="_blank" rel="noopener noreferrer">pirateruler.com</a></div>
</aside>

<script>
/* World Time — client-side (no API) */
/* 1) Collect zone list from Intl if available
   2) Show 10 famous zones by default
   3) Search filters client-side
   4) Live clocks via setInterval
*/

const el = id => document.getElementById(id);
el('year').textContent = new Date().getFullYear();

// HTML elements
const searchInput = el('searchInput');
const zonesList = el('zonesList');
const countLabel = el('countLabel');
const refreshBtn = el('refreshBtn');
const presetSelect = el('presetSelect');
const showAllBtn = el('showAllBtn');
const utcNowEl = el('utcNow');
const themeBtn = el('themeBtn');
const themeList = document.getElementById('themeList');
const themeSelectWrap = document.getElementById('themeSelectWrap');
const hambBtn = el('hambBtn');
const sidebar = document.getElementById('sidebar');
const closeSidebar = el('closeSidebar');
const closeSidebar2 = el('closeSidebar2');
const jumpLocal = el('jumpLocal');
const showUTC = el('showUTC');
const copyZonesBtn = el('copyZones');

let allZones = [];
let visibleZones = []; // currently displayed zones (strings)
let liveTimer = null;
let showingAll = false;

/* Famous / top 10 zones to show first (human-friendly list) */
const FAMOUS_ZONES = [
  'UTC',
  'Europe/London',
  'Europe/Paris',
  'Europe/Berlin',
  'America/New_York',
  'America/Los_Angeles',
  'Asia/Tokyo',
  'Asia/Shanghai',
  'Asia/Kolkata',
  'Australia/Sydney'
];

/* gather zone list */
function loadZones(){
  // prefer Intl.supportedValuesOf('timeZone') when available
  if(typeof Intl === 'object' && typeof Intl.supportedValuesOf === 'function'){
    try{
      const tz = Intl.supportedValuesOf('timeZone');
      if(Array.isArray(tz) && tz.length) { allZones = tz.slice(); return; }
    }catch(e){ /* fallthrough to fallback list */ }
  }

  // fallback generous list (subset, but still large) — add more if you like
  allZones = [
    "UTC","Europe/London","Europe/Paris","Europe/Berlin","Europe/Madrid","Europe/Moscow",
    "America/New_York","America/Chicago","America/Denver","America/Los_Angeles","America/Toronto",
    "America/Sao_Paulo","America/Mexico_City","Asia/Tokyo","Asia/Seoul","Asia/Shanghai","Asia/Kolkata",
    "Asia/Dubai","Asia/Singapore","Australia/Sydney","Pacific/Auckland","Africa/Johannesburg","Africa/Cairo",
    "Europe/Rome","Europe/Amsterdam","Europe/Zurich","Europe/Stockholm","America/Argentina/Buenos_Aires",
    "America/Vancouver","Asia/Hong_Kong","Asia/Bangkok","Asia/Jerusalem","Asia/Manila","Atlantic/Reykjavik",
    "Asia/Kathmandu","Asia/Colombo","Asia/Almaty","Asia/Taipei","Pacific/Guam","Pacific/Honolulu"
  ];
}

/* format time for a timezone (ISO-ish) */
function formatZoneTime(tz, date){
  try{
    const fmt = new Intl.DateTimeFormat(undefined, {
      timeZone: tz,
      hour: '2-digit', minute: '2-digit', second: '2-digit',
      year:'numeric', month:'2-digit', day:'2-digit',
      hour12: false
    });
    // Using formatToParts to reconstruct a stable string
    const parts = fmt.formatToParts(date);
    const map = {};
    for(const p of parts) map[p.type] = (map[p.type] || '') + p.value;
    const time = `${map.hour || '00'}:${map.minute || '00'}:${map.second || '00'}`;
    const localDate = `${map.year || ''}-${map.month || ''}-${map.day || ''}`;
    // compute offset (approx) by using Date for tz vs UTC
    const utc = new Date(date.toLocaleString('en-US',{ timeZone: 'UTC' }));
    const local = new Date(date.toLocaleString('en-US',{ timeZone: tz }));
    const diffMinutes = Math.round((local - utc) / 60000);
    const sign = diffMinutes >= 0 ? '+' : '-';
    const hh = String(Math.floor(Math.abs(diffMinutes)/60)).padStart(2,'0');
    const mm = String(Math.abs(diffMinutes)%60).padStart(2,'0');
    const offset = `UTC${sign}${hh}:${mm}`;
    return { time, localDate, offset };
  }catch(e){
    return { time: '—', localDate: '—', offset: 'UTC?'} ;
  }
}

/* build zone element */
function makeZoneRow(tz){
  const row = document.createElement('div');
  row.className = 'zone-row';
  row.dataset.tz = tz;

  const top = document.createElement('div'); top.className = 'zone-top';
  const name = document.createElement('div'); name.className = 'zone-name'; name.textContent = tz;
  const live = document.createElement('div'); live.className = 'zone-time'; live.textContent = '—:—:—';
  top.appendChild(name); top.appendChild(live);

  const meta = document.createElement('div'); meta.className = 'zone-meta';
  meta.textContent = '— • —';

  row.appendChild(top); row.appendChild(meta);

  // store references for updates
  row._liveEl = live;
  row._metaEl = meta;
  return row;
}

/* render zone list (visibleZones array) */
function renderZones(list){
  zonesList.innerHTML = '';
  if(list.length === 0){
    zonesList.innerHTML = '<div class="tiny">No zones found.</div>';
    countLabel.textContent = '0';
    return;
  }
  const fragment = document.createDocumentFragment();
  for(const tz of list){
    fragment.appendChild(makeZoneRow(tz));
  }
  zonesList.appendChild(fragment);
  countLabel.textContent = String(list.length);
  // initial update
  updateClocks();
}

/* update clocks per second */
function updateClocks(){
  const nodes = Array.from(zonesList.querySelectorAll('.zone-row'));
  const now = new Date();
  utcNowEl.textContent = now.toISOString();
  for(const node of nodes){
    const tz = node.dataset.tz;
    const { time, localDate, offset } = formatZoneTime(tz, now);
    node._liveEl.textContent = time;
    node._metaEl.textContent = `${localDate} · ${offset}`;
  }
}

/* debounced search */
let searchTimer = null;
function applySearch(){
  const q = (searchInput.value || '').trim().toLowerCase();
  // if showingAll false => start from famous or first set
  let base = showingAll ? allZones : FAMOUS_ZONES.filter(z => allZones.includes(z));
  if(presetSelect.value === 'all') base = allZones.slice();

  let results;
  if(!q){
    results = base.slice();
  }else{
    results = base.filter(z => z.toLowerCase().includes(q) || z.split('/').some(p=>p.toLowerCase().includes(q)));
    // if not enough matches in base, also search full list (useful when user typed city)
    if(results.length < 10){
      const more = allZones.filter(z => z.toLowerCase().includes(q) || z.split('/').some(p=>p.toLowerCase().includes(q)));
      // merge unique
      const set = new Set(results);
      for(const m of more){
        if(!set.has(m)) results.push(m);
      }
    }
  }
  // only show top N unless showingAll
  if(!showingAll) results = results.slice(0, 10);
  visibleZones = results;
  renderZones(visibleZones);
}

/* initialize everything */
function init(){
  loadZones();

  // ensure allZones unique & sorted for stability
  allZones = Array.from(new Set(allZones)).sort((a,b) => a.localeCompare(b));

  // default visible: famous zones (filter by actual availability)
  const availableFamous = FAMOUS_ZONES.filter(z => allZones.includes(z));
  visibleZones = availableFamous.length ? availableFamous : allZones.slice(0,10);
  renderZones(visibleZones);

  // start live timer
  if(liveTimer) clearInterval(liveTimer);
  liveTimer = setInterval(updateClocks, 1000);

  // wire events
  searchInput.addEventListener('input', ()=> {
    clearTimeout(searchTimer);
    searchTimer = setTimeout(applySearch, 180);
  });

  refreshBtn.addEventListener('click', ()=> {
    // re-run timezone collection (useful after browser updates)
    loadZones();
    allZones = Array.from(new Set(allZones)).sort((a,b) => a.localeCompare(b));
    showingAll = false;
    showAllBtn.textContent = 'Show all zones';
    presetSelect.value = 'famous';
    init(); // re-init
  });

  presetSelect.addEventListener('change', ()=> {
    showingAll = (presetSelect.value === 'all');
    showAllBtn.textContent = showingAll ? 'Show top 10' : 'Show all zones';
    applySearch();
  });

  showAllBtn.addEventListener('click', ()=> {
    showingAll = !showingAll;
    showAllBtn.textContent = showingAll ? 'Show top 10' : 'Show all zones';
    presetSelect.value = showingAll ? 'all' : 'famous';
    applySearch();
  });

  // sidebar handlers
  hambBtn.addEventListener('click', ()=> {
    sidebar.classList.toggle('open');
    sidebar.setAttribute('aria-hidden', sidebar.classList.contains('open') ? 'false' : 'true');
  });
  closeSidebar.addEventListener('click', ()=> { sidebar.classList.remove('open'); sidebar.setAttribute('aria-hidden','true'); });
  closeSidebar2.addEventListener('click', ()=> { sidebar.classList.remove('open'); sidebar.setAttribute('aria-hidden','true'); });

  // quick actions
  jumpLocal.addEventListener('click', ()=> {
    const local = Intl.DateTimeFormat().resolvedOptions().timeZone || 'UTC';
    searchInput.value = local;
    showingAll = false;
    presetSelect.value = 'famous';
    applySearch();
    // expand to local if not found
    if(!visibleZones.includes(local) && allZones.includes(local)){
      showingAll = true; presetSelect.value = 'all'; showAllBtn.textContent = 'Show top 10';
      searchInput.value = local;
      applySearch();
    }
  });

  showUTC.addEventListener('click', ()=> {
    searchInput.value = 'UTC';
    presetSelect.value = 'all';
    showingAll = true;
    showAllBtn.textContent = 'Show top 10';
    applySearch();
  });

  copyZonesBtn.addEventListener('click', async ()=>{
    try{
      const text = allZones.join('\n');
      if(navigator.clipboard) await navigator.clipboard.writeText(text);
      else {
        const ta = document.createElement('textarea'); ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove();
      }
      alert('Zone list copied to clipboard (' + allZones.length + ' items)');
    }catch(e){ alert('Copy failed'); }
  });

  // theme handling
  themeBtn.addEventListener('click', ()=> { themeList.style.display = themeList.style.display === 'block' ? 'none' : 'block'; });
  Array.from(document.querySelectorAll('.theme-item')).forEach(it => it.addEventListener('click', ()=> {
    const name = it.dataset.theme;
    ['dark','ocean','sunset'].forEach(c=>document.documentElement.classList.remove(c));
    if(name !== 'light') document.documentElement.classList.add(name);
    themeBtn.textContent = (name.charAt(0).toUpperCase()+name.slice(1)) + ' ▾';
    localStorage.setItem('pr-theme', name);
    themeList.style.display = 'none';
  }));
  (function initTheme(){
    const t = localStorage.getItem('pr-theme') || 'ocean';
    if(t !== 'light') document.documentElement.classList.add(t);
    themeBtn.textContent = (t.charAt(0).toUpperCase()+t.slice(1)) + ' ▾';
  })();

  // outside clicks close theme list & small-screen sidebar
  document.addEventListener('click', (e)=> {
    if(!themeSelectWrap.contains(e.target)) themeList.style.display='none';
    if(sidebar.classList.contains('open') && !sidebar.contains(e.target) && !hambBtn.contains(e.target)) {
      sidebar.classList.remove('open'); sidebar.setAttribute('aria-hidden','true');
    }
  });

  // allow Enter to search
  searchInput.addEventListener('keydown', e => { if(e.key === 'Enter') applySearch(); });

  // initial applySearch to ensure search box state applied
  applySearch();
}

/* start */
init();

</script>
</body>
</html>
